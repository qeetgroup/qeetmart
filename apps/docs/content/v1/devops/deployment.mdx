---
title: Deployment
description: Deployment blueprint for Vercel-hosted docs and Kubernetes-hosted platform services.
section: DevOps
lastUpdated: 2026-02-20
---

## Deployment model

- Docs app deploys from `apps/docs`.
- Runtime platform deploys from `platform/` and `helm/`.
- Environments: `dev`, `staging`, `prod`.

<Callout title="Promotion policy" tone="warning">
  Promotion must be sequential: `dev` -> `staging` -> `prod`. Skip-level promotion is not allowed.
</Callout>

## Vercel docs deployment

1. Connect repo and set root directory to `apps/docs`.
2. Build command: `pnpm --filter docs build`.
3. Output: Next.js managed output.
4. Add `NEXT_PUBLIC_DOCS_DEFAULT_VERSION=v1`.

## Kubernetes platform deployment

- Validate Helm chart before release:

```bash
helm lint helm/qeetmart
kustomize build platform/k8s/overlays/staging > /tmp/staging.yaml
```

- Promote image tags via deployment workflow (`.github/workflows/deploy.yml`).
- Rollback path: redeploy prior stable image tag.

## Rollout workflow

<Steps>
  <Step title="1. Preflight checks">

```bash
helm lint helm/qeetmart
kustomize build platform/k8s/overlays/dev > /tmp/dev.yaml
```

  </Step>
  <Step title="2. Deploy to staging">

```bash
kustomize build platform/k8s/overlays/staging > /tmp/staging.yaml
```

  </Step>
  <Step title="3. Verify health + smoke">

```bash
curl https://gateway.staging.qeetmart.internal/health
```

  </Step>
  <Step title="4. Promote to production">

Deploy via `.github/workflows/deploy.yml` with approved tag.

  </Step>
  <Step title="5. Rollback if SLO degrades">

Redeploy previous stable image tag and capture incident notes.

  </Step>
</Steps>

## CDN and cache guidance

- Static assets: immutable cache (`max-age=31536000, immutable`).
- HTML and docs routes: `stale-while-revalidate` strategy.
- Invalidate docs cache on merge to `main` and release tags.
